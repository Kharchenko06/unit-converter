<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="'width=device-width, initial-scale=1.0">
        <title>–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –≤–µ–ª–∏—á–∏–Ω</title>

        <style>

        </style>
    </head>
    <body>

        <div class="card">
            <h1>üîÅ –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä</h1>

            <div class="tabs">
                {% for code, data in units_data.items() %}
                    <a href="/?category={{ code }}" 
                    class="tab {{ 'active' if current_cat == code else '' }}">
                    {{ data['name'] }}
                    </a>
                {% endfor %}
            </div>

            <form method="POST">
                <input type="hidden" name="category" value="{{ current_cat }}">

                <div class="form-grid">
                    
                    <div>
                        <label>–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ:</label>
                        <input type="number" step="any" name="amount" value="{{ amount }}" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 100">
                    </div>

                    <div class="units-row">
                        <div class="unit-box">
                            <label>–ò–∑:</label>
                            <select name="unit_from">
                                {% for code, u in units_data[current_cat]['units'].items() %}
                                    <option value="{{ code }}" {{ 'selected' if unit_from == code else '' }}>
                                        {{ u['name'] }}
                                    </option>
                                {% endfor %}
                            </select>
                        </div>

                        <button type="submit" name="action" value="swap" class="swap-btn" title="–ü–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏">
                            ‚áÖ
                        </button>

                        <div class="unit-box">
                            <label>–í:</label>
                            <select name="unit_to">
                                {% for code, u in units_data[current_cat]['units'].items() %}
                                    <option value="{{ code }}" {{ 'selected' if unit_to == code else '' }}>
                                        {{ u['name'] }}
                                    </option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <button type="submit" name="action" value="convert" class="action-btn">
                        –†–∞—Å—Å—á–∏—Ç–∞—Ç—å
                    </button>
                </div>
            </form>

            {% if result %}
            <div class="result-box">
                <div class="res-main">{{ result }}</div>
                <div class="res-sub">{{ explanation }}</div>
            </div>
            {% endif %}

            {% if history %}
            <div class="history">
                <h3>–ò—Å—Ç–æ—Ä–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</h3>
                <ul>
                    {% for item in history %}
                        <li>
                            <span>{{ item.from_val }}</span>
                            <span style="color: var(--text-sec);">‚Üí</span>
                            <span style="font-weight: bold;">{{ item.to_val }}</span>
                        </li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

        </div>

    </body>
</html>